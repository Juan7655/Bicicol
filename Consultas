//Consulta 1

SELECT SUM(Cm.ValorTotal)Egresos,(SUM(Va.Cantidad*Acc.precio)+SUM(Vc.Cantidad*Com.precio)+
SUM(Vb.Cantidad*Bi.precio))Ingresos
FROM Compra Cm,venta_accesorio Va INNER JOIN Accesorio Acc INNER JOIN venta V INNER JOIN venta_componente Vc
INNER JOIN componente Com INNER JOIN venta_bicleta Vb INNER JOIN bicicleta Bi
ON Va.refaccesorio=Acc.referencia AND Vc.refcomponente=Com.referencia AND Vb.refbicicleta=Bi.referencia
AND V.idventa=Va.idventa AND V.idventa=Vc.idventa AND V.idventa=Vb.idventa
;
#Anacleta. Aqui hay un problema y es que los egresos no muestran el valor que debe ser.

//Consulta 2

SELECT MONTH(V.Fecha)Mes,(Tb.nombre)TipoMasVendido,(Vb.cantidad*Bi.precio)Ganancia
FROM tipobicicleta Tb INNER JOIN bicicleta Bi INNER JOIN venta_bicleta Vb INNER JOIN venta V
ON Tb.IdTipoBic=Bi.tipo AND Bi.referencia=Vb.refbicicleta AND V.idventa=Vb.idventa
WHERE Vb.cantidad*Bi.precio=(SELECT MIN(Vbb.cantidad*Bic.precio) 
FROM tipobicicleta T INNER JOIN bicicleta Bic INNER JOIN venta_bicleta Vbb INNER JOIN venta Ve
ON T.IdTipoBic=Bic.tipo AND Bic.referencia=Vbb.refbicicleta AND Ve.idventa=Vbb.idventa
WHERE MONTH(V.Fecha)=MONTH(Ve.Fecha))
GROUP BY MONTH(V.Fecha);

#Anacleta. Funciona . Al menos con los datos que tenemos

//Consulta 3
SELECT (C.Nombre)Cliente, V.Fecha,(E.Nombre)Vendedor,(TB.Nombre)Bicicleta, (TA.Nombre)Accesorio, (TC.Nombre)Componente
FROM Venta V INNER JOIN Cliente C INNER JOIN Empleado E INNER JOIN Venta_Bicleta VB INNER JOIN Bicicleta B INNER JOIN TipoBicicleta TB INNER JOIN Venta_Accesorio VA INNER JOIN Accesorio A INNER JOIN TipoAccesorio TA  INNER JOIN Venta_Componente VC INNER JOIN Componente Co INNER JOIN TipoComponente TC
ON V.Cliente=C.Documento AND E.Documento= V.Empleado AND VB.IdVenta= V.IdVenta AND B.Referencia= VB.RefBicicleta AND TB.IdTipoBic= B.Tipo  AND VA.IdVenta= V.IdVenta AND A.Referencia= VA.RefAccesorio AND TA.IdTipoAcc= A.Tipo  AND VC.IdVenta= V.IdVenta AND Co.Referencia= VC.RefComponente AND TC.IdTipoCom= Co.Tipo
ORDER BY C.Nombre, E.Nombre, TB.Nombre, TA.Nombre, TC.Nombre;

/*Consulta 5*/

SELECT Bici.Referencia Ref, TipB.nombre Tipo_Bici, BiciComp.RefComponente , TipC.Nombre Nom_Componente, M.Nombre Marca
FROM Bicicleta Bici
INNER JOIN TipoBicicleta TipB ON Bici.Tipo = TipB.IdTipoBic
	INNER JOIN Bicicleta_Componente BiciComp ON Bici.Referencia = BiciComp.RefBicicleta
		INNER JOIN Componente Comp ON BiciComp.RefComponente = Comp.Referencia
			INNER JOIN TipoComponente TipC ON Comp.Referencia = TipC.IdTipoCom
				INNER JOIN Marca M ON Comp.Marca = M.IdMarca;
#Pandolfo. Funciona bien, pero se podría ver mejor, además es sumamente sencillo.				


